<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>Data &#8212; Apache MXNet  documentation</title>

    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mxnet.css" />
    <link rel="stylesheet" href="../../../_static/material-design-lite-1.3.0/material.blue-deep_orange.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx_materialdesign_theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/fontawesome/all.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/fonts.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/google_analytics.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../../_static/mxnet-icon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Image Augmentation" href="image-augmentation.html" />
    <link rel="prev" title="How to write a custom layer in Apache MxNet Gluon API" href="custom_layer_beginners.html" /> 
  </head>
<body><header class="site-header" role="banner">
  <div class="wrapper">
      <a class="site-title" rel="author" href="/"><img
            src="../../../_static/mxnet_logo.png" class="site-header-logo"></a>
    <nav class="site-nav">
      <input type="checkbox" id="nav-trigger" class="nav-trigger"/>
      <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
      </label>

      <div class="trigger">
        <a class="page-link" href="/get_started">Get Started</a>
        <a class="page-link" href="/blog">Blog</a>
        <a class="page-link" href="/features">Features</a>
        <a class="page-link" href="/ecosystem">Ecosystem</a>
        <a class="page-link page-current" href="/api">Docs & Tutorials</a>
        <a class="page-link" href="https://github.com/apache/incubator-mxnet">GitHub</a>
      </div>
    </nav>
  </div>
</header>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer"><header class="mdl-layout__header mdl-layout__header--waterfall ">
    <div class="mdl-layout__header-row">
        
        <nav class="mdl-navigation breadcrumb">
            <a class="mdl-navigation__link" href="../../index.html">Python Tutorials</a><i class="material-icons">navigate_next</i>
            <a class="mdl-navigation__link" href="../index.html">Packages</a><i class="material-icons">navigate_next</i>
            <a class="mdl-navigation__link" href="index.html">Gluon</a><i class="material-icons">navigate_next</i>
            <a class="mdl-navigation__link is-active">Data</a>
        </nav>
        <div class="mdl-layout-spacer"></div>
        <nav class="mdl-navigation">
        
<form class="form-inline pull-sm-right" action="../../../search.html" method="get">
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
        <label id="quick-search-icon" class="mdl-button mdl-js-button mdl-button--icon"  for="waterfall-exp">
          <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="q"  id="waterfall-exp" placeholder="Search" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </div>
      </div>
      <div class="mdl-tooltip" data-mdl-for="quick-search-icon">
      Quick search
      </div>
</form>
        
<a id="button-show-source"
    class="mdl-button mdl-js-button mdl-button--icon"
    href="../../../_sources/tutorials/packages/gluon/data.ipynb" rel="nofollow">
  <i class="material-icons">code</i>
</a>
<div class="mdl-tooltip" data-mdl-for="button-show-source">
Show Source
</div>
        </nav>
    </div>
    <div class="mdl-layout__header-row header-links">
      <div class="mdl-layout-spacer"></div>
      <nav class="mdl-navigation">
      </nav>
    </div>
</header><header class="mdl-layout__drawer">      
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Python Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/crash-course/index.html">Crash Course</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/to-mxnet/index.html">Moving to MXNet from Other Frameworks</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Packages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Gluon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ndarray/index.html">NDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../symbol/index.html">Symbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autograd/autograd.html">Automatic Differentiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onnx/index.html">ONNX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../performance/index.html">Performance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../performance/compression/index.html">Compression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../performance/backend/index.html">Accelerated Backend Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../deploy/index.html">Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../deploy/export/index.html">Export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../deploy/inference/index.html">Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../deploy/run-on-aws/index.html">Run on AWS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extend/index.html">Customization</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ndarray/index.html">mxnet.ndarray</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/mxnet.ndarray.NDArray.html">NDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/routines.html">Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/mxnet.ndarray.sparse.CSRNDArray.html">CSRNDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/mxnet.ndarray.sparse.RowSparseNDArray.html">RowSparseNDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/sparse_routines.html">Sparse routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/gluon/index.html">mxnet.gluon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/nn.html">nn and contrib.nn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/rnn.html">rnn and contrib.rnn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.loss.html"><code class="docutils literal notranslate"><span class="pre">loss</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.parameter.html">Parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.Trainer.html">Trainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.data.html">data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.data.vision.html">data.vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.model_zoo.html">model_zoo.vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/gluon-related/index.html">Gluon related modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.autograd.html">mxnet.autograd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.image.html">mxnet.image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.io.html">mxnet.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.recordio.html">mxnet.recordio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.kvstore.html">mxnet.kvstore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.optimizer.html">mxnet.optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.random.html">mxnet.random</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.profiler.html">mxnet.profiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.context.html">mxnet.context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.initializer.html">mxnet.initializer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.lr_scheduler.html">mxnet.lr_scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.metric.html">mxnet.metric</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/symbol/index.html">mxnet.symbol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol/mxnet.symbol.Symbol.html">Symbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol/mxnet.symbol.linalg.html">mxnet.linalg</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/symbol-related/index.html">Symbol related modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol-related/mxnet.callback.html">mxnet.callback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol-related/mxnet.module.html">mxnet.module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol-related/mxnet.monitor.html">mxnet.monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol-related/mxnet.visualization.html">mxnet.visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/advanced/index.html">Advanced modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.executor.html">mxnet.executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.kvstore_server.html">mxnet.kvstore_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.engine.html">mxnet.engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.executor_manager.html">mxnet.executor_manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.rtc.html">mxnet.rtc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.test_utils.html">mxnet.test_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.util.html">mxnet.util</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        
        </div>
    
</header>
        <main class="mdl-layout__content" tabIndex="0">

	<script type="text/javascript" src="../../../_static/sphinx_materialdesign_theme.js "></script>
    <header class="mdl-layout__drawer">      
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Python Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/crash-course/index.html">Crash Course</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/to-mxnet/index.html">Moving to MXNet from Other Frameworks</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Packages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Gluon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ndarray/index.html">NDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../symbol/index.html">Symbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autograd/autograd.html">Automatic Differentiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onnx/index.html">ONNX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../performance/index.html">Performance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../performance/compression/index.html">Compression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../performance/backend/index.html">Accelerated Backend Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../deploy/index.html">Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../deploy/export/index.html">Export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../deploy/inference/index.html">Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../deploy/run-on-aws/index.html">Run on AWS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extend/index.html">Customization</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ndarray/index.html">mxnet.ndarray</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/mxnet.ndarray.NDArray.html">NDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/routines.html">Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/mxnet.ndarray.sparse.CSRNDArray.html">CSRNDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/mxnet.ndarray.sparse.RowSparseNDArray.html">RowSparseNDArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ndarray/sparse_routines.html">Sparse routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/gluon/index.html">mxnet.gluon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/nn.html">nn and contrib.nn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/rnn.html">rnn and contrib.rnn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.loss.html"><code class="docutils literal notranslate"><span class="pre">loss</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.parameter.html">Parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.Trainer.html">Trainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.data.html">data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.data.vision.html">data.vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.model_zoo.html">model_zoo.vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon/mxnet.gluon.utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/gluon-related/index.html">Gluon related modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.autograd.html">mxnet.autograd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.image.html">mxnet.image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.io.html">mxnet.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.recordio.html">mxnet.recordio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.kvstore.html">mxnet.kvstore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.optimizer.html">mxnet.optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.random.html">mxnet.random</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.profiler.html">mxnet.profiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.context.html">mxnet.context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.initializer.html">mxnet.initializer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.lr_scheduler.html">mxnet.lr_scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/gluon-related/mxnet.metric.html">mxnet.metric</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/symbol/index.html">mxnet.symbol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol/mxnet.symbol.Symbol.html">Symbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol/mxnet.symbol.linalg.html">mxnet.linalg</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/symbol-related/index.html">Symbol related modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol-related/mxnet.callback.html">mxnet.callback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol-related/mxnet.module.html">mxnet.module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol-related/mxnet.monitor.html">mxnet.monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/symbol-related/mxnet.visualization.html">mxnet.visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/advanced/index.html">Advanced modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.executor.html">mxnet.executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.kvstore_server.html">mxnet.kvstore_server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.engine.html">mxnet.engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.executor_manager.html">mxnet.executor_manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.rtc.html">mxnet.rtc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.test_utils.html">mxnet.test_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/advanced/mxnet.util.html">mxnet.util</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        
        </div>
    
</header>

    <div class="document">
        <div class="page-content">
        
  <div class="section" id="Data">
<h1>Data<a class="headerlink" href="#Data" title="Permalink to this headline">¶</a></h1>
<p>One of the most critical steps for model training and inference is loading the data: without data you can’t do deep learning! In this tutorial we use the <code class="docutils literal notranslate"><span class="pre">data</span></code> module to:</p>
<ol class="arabic simple">
<li><p>Define a <code class="docutils literal notranslate"><span class="pre">`Dataset</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html</a>&gt;`__</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">transform</span></code>s to augment the dataset</p></li>
<li><p>Use a <code class="docutils literal notranslate"><span class="pre">`DataLoader</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html</a>&gt;`__ to iterate through the dataset in mini-batches</p></li>
</ol>
<div class="section" id="Getting-started-with-`Dataset-&lt;https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html&gt;`__s">
<h2>Getting started with <code class="docutils literal notranslate"><span class="pre">`Dataset</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html</a>&gt;`__s<a class="headerlink" href="#Getting-started-with-`Dataset-<https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html>`__s" title="Permalink to this headline">¶</a></h2>
<p>Our very first step is to define the <code class="docutils literal notranslate"><span class="pre">`Dataset</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html</a>&gt;`__. A <code class="docutils literal notranslate"><span class="pre">`Dataset</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html</a>&gt;`__ is MXNet Gluon’s interface to the data that’s stored on disk (or elsewhere). Out of the box, MXNet Gluon comes with a number of common benchmarking datasets such as CIFAR-10 and MNIST. We’ll use an MNIST variant, called FashionMNIST, to understand the role of the
<code class="docutils literal notranslate"><span class="pre">`Dataset</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html</a>&gt;`__. When we instantiate this benchmarking dataset, the data will be downloaded to disk and be ready to use.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mxnet</span> <span class="k">as</span> <span class="nn">mx</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">gluon</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">vision</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">()</span>
</pre></div>
</div>
<p>So how do we get data out of a <code class="docutils literal notranslate"><span class="pre">`Dataset</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html</a>&gt;`__? We index.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span>
</pre></div>
</div>
<p>Choosing a random index of 42 above, we get back a single sample from the dataset. A single sample usually contains multiple elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>Our sample has 2 elements in this case. We have the image as the first element and the label as the second. Although this is a common pattern, you should check the documentation (or implementation) of the dataset you’re using.</p>
<p>We can unpack the sample into <code class="docutils literal notranslate"><span class="pre">data</span></code> and <code class="docutils literal notranslate"><span class="pre">label</span></code> and visualise our single sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_sample</span><span class="p">,</span> <span class="n">label_sample</span> <span class="o">=</span> <span class="n">sample</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Clothing Category #</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label_sample</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">s</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">data_sample</span><span class="p">)</span>
</pre></div>
</div>
<p>We can access all of our samples in the dataset using the indexing method above, but usually we leave this to the <code class="docutils literal notranslate"><span class="pre">`DataLoader</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html</a>&gt;`__. We’ll see an example of this shortly, but first we’ll see how to change our dataset with <code class="docutils literal notranslate"><span class="pre">transform</span></code>s.</p>
</div>
<div class="section" id="Getting-started-with-transforms">
<h2>Getting started with <code class="docutils literal notranslate"><span class="pre">transform</span></code>s<a class="headerlink" href="#Getting-started-with-transforms" title="Permalink to this headline">¶</a></h2>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">dataset</span></code>s which return individual samples, <code class="docutils literal notranslate"><span class="pre">transform</span></code>s give us a way to change individual samples of our <code class="docutils literal notranslate"><span class="pre">dataset</span></code>.</p>
<div class="section" id="Why-would-you-want-to-do-this?">
<h3>Why would you want to do this?<a class="headerlink" href="#Why-would-you-want-to-do-this?" title="Permalink to this headline">¶</a></h3>
<p>Most of the time, samples returned by the dataset aren’t in quite the right format to be passed into a neural network. One common example is to have samples with a data type of <code class="docutils literal notranslate"><span class="pre">int8</span></code> when your network expects <code class="docutils literal notranslate"><span class="pre">float32</span></code>. Another common example with images is when you have an image with a dimension order of (height, width, channel) when you need (channel, height, width) for the network.</p>
<p>Augmenting samples is also common practice: that is, randomly permuting existing samples to make new samples to reduce issues of network overfitting. Using image samples as an example, you could crop to random regions, flip from left to right or even jitter the brightness of the image.</p>
</div>
<div class="section" id="And-how-do-you-do-it?">
<h3>And how do you do it?<a class="headerlink" href="#And-how-do-you-do-it?" title="Permalink to this headline">¶</a></h3>
<p>We first define our transform and then apply it to our dataset.</p>
<p>MXNet Gluon has a number of in-build transforms available at <code class="docutils literal notranslate"><span class="pre">mxnet.gluon.data.vision.transforms</span></code>, so let’s use <code class="docutils literal notranslate"><span class="pre">`RandomResizedCrop</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.vision.transforms.RandomResizedCrop.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.vision.transforms.RandomResizedCrop.html</a>&gt;`__ as an example. We’re specifying that we want a random crop that contains 60% to 80% of the original image, and then we want to scale this cropped region to 20px by 20px. You should notice we’re instantiating a class that can be called like a function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mxnet.gluon.data.vision.transforms</span> <span class="k">import</span> <span class="n">RandomResizedCrop</span>

<span class="n">transform_fn</span> <span class="o">=</span> <span class="n">RandomResizedCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span>
</pre></div>
</div>
<p>After defining <code class="docutils literal notranslate"><span class="pre">transform_fn</span></code>, we now need to apply it to the dataset. We call the <code class="docutils literal notranslate"><span class="pre">transform_first</span></code> method of our dataset to apply <code class="docutils literal notranslate"><span class="pre">transform_fn</span></code> to the first element of all samples. We had 2 elements per sample in our example, so we only apply <code class="docutils literal notranslate"><span class="pre">transform_fn</span></code> to the image and not the label.</p>
<p>Advanced: <code class="docutils literal notranslate"><span class="pre">transform</span></code>, instead of <code class="docutils literal notranslate"><span class="pre">transform_first</span></code> can be used to transform all elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transform_first</span><span class="p">(</span><span class="n">transform_fn</span><span class="p">)</span>
</pre></div>
</div>
<p>When we retrieve the same sample as before from the dataset, we now see an augmented version of the image (with the same label). We’d see a different augmented image every time we retrieve this sample because the transform is applied lazily by default.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_sample</span><span class="p">,</span> <span class="n">label_sample</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Clothing Category #</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label_sample</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">data_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Getting-started-with-`DataLoader-&lt;https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html&gt;`__s">
<h2>Getting started with <code class="docutils literal notranslate"><span class="pre">`DataLoader</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html</a>&gt;`__s<a class="headerlink" href="#Getting-started-with-`DataLoader-<https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html>`__s" title="Permalink to this headline">¶</a></h2>
<p>Our <code class="docutils literal notranslate"><span class="pre">dataset</span></code> gives us individual samples, but we usually train neural networks on batches of samples. A <code class="docutils literal notranslate"><span class="pre">`DataLoader</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html</a>&gt;`__ retrieves samples from the <code class="docutils literal notranslate"><span class="pre">dataset</span></code> and stacks them into batches. At a minimum, all we need to specify is the number of samples we want in each batch, called the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code>, but <code class="docutils literal notranslate"><span class="pre">`DataLoader</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html</a>&gt;`__s have many other
useful features. Shuffling data samples for training is as simple as setting <code class="docutils literal notranslate"><span class="pre">shuffle</span></code>.</p>
<p>Advanced: A larger <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> often speeds up training, but can lead to out-of-memory and convergence issues. 12345 is just for demonstration purposes: you’ll more commonly use a smaller batch size (e.g. 128) but it depends on the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataloader</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">gluon</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span>
                                      <span class="n">batch_size</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
                                      <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>We iterate through the <code class="docutils literal notranslate"><span class="pre">dataloader</span></code> to get all the batches in our <code class="docutils literal notranslate"><span class="pre">dataset</span></code>, and we usually place the code for network training inside this loop. You’ll notice that <code class="docutils literal notranslate"><span class="pre">data_batch</span></code> has an extra dimension at the start (compared with <code class="docutils literal notranslate"><span class="pre">data_sample</span></code>): this is often called the batch dimension.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data_batch</span><span class="p">,</span> <span class="n">label_batch</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Batch </span><span class="si">{}</span><span class="s1"> has shape </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">batch_idx</span><span class="p">,</span> <span class="n">data_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
<p>You might have noticed that the last batch contains fewer samples than the others. We had a remainder at the end and by default a <code class="docutils literal notranslate"><span class="pre">`DataLoader</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html</a>&gt;`__ keeps the incomplete batch (see <code class="docutils literal notranslate"><span class="pre">last_batch</span></code> argument).</p>
<p>We can plot a few (augmented) images from the last batch.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">);</span> <span class="n">plot</span><span class="p">(</span><span class="n">data_batch</span><span class="p">[</span><span class="mi">123</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">);</span> <span class="n">plot</span><span class="p">(</span><span class="n">data_batch</span><span class="p">[</span><span class="mi">234</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">);</span> <span class="n">plot</span><span class="p">(</span><span class="n">data_batch</span><span class="p">[</span><span class="mi">345</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>We’ve now seen all of the core components of the MXNet Gluon data pipeline. You should now understand the difference between <code class="docutils literal notranslate"><span class="pre">`Dataset</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html</a>&gt;`__s, that return individual samples, and <code class="docutils literal notranslate"><span class="pre">`DataLoader</span></code> &lt;<a class="reference external" href="https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html">https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html</a>&gt;`__s, that return batches of samples. You should also be able to transform your <code class="docutils literal notranslate"><span class="pre">dataset</span></code> for pre-processing or augmentation purposes.</p>
</div>
<div class="section" id="Recommended-Next-Steps">
<h2>Recommended Next Steps<a class="headerlink" href="#Recommended-Next-Steps" title="Permalink to this headline">¶</a></h2>
<p>We used presets and a lot of default values in this tutorial, but there are many other options and possibilities. You’re likely to want to use your own dataset for training. You can learn more about this in the dedicated <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> tutorial. We also have a tutorial on <code class="docutils literal notranslate"><span class="pre">transform</span></code>s with examples on how to compose transform operations. And last but not least, we have a very useful tutorial on <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code>s. You’ll often find that loading data can be the bottleneck to training, and this
tutorial contains some useful tricks to speed up the data pipeline.</p>
</div>
</div>


        </div>
        <div class="side-doc-outline">
            <div class="side-doc-outline--content"> 
<div class="localtoc">
    <p class="caption">
      <span class="caption-text">Table Of Contents</span>
    </p>
    <ul>
<li><a class="reference internal" href="#">Data</a><ul>
<li><a class="reference internal" href="#Getting-started-with-`Dataset-&lt;https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html&gt;`__s">Getting started with <code class="docutils literal notranslate"><span class="pre">`Dataset</span></code> &lt;https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.Dataset.html&gt;`__s</a></li>
<li><a class="reference internal" href="#Getting-started-with-transforms">Getting started with <code class="docutils literal notranslate"><span class="pre">transform</span></code>s</a><ul>
<li><a class="reference internal" href="#Why-would-you-want-to-do-this?">Why would you want to do this?</a></li>
<li><a class="reference internal" href="#And-how-do-you-do-it?">And how do you do it?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Getting-started-with-`DataLoader-&lt;https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html&gt;`__s">Getting started with <code class="docutils literal notranslate"><span class="pre">`DataLoader</span></code> &lt;https://beta.mxnet.io/api/gluon/_autogen/mxnet.gluon.data.DataLoader.html&gt;`__s</a></li>
<li><a class="reference internal" href="#Conclusion">Conclusion</a></li>
<li><a class="reference internal" href="#Recommended-Next-Steps">Recommended Next Steps</a></li>
</ul>
</li>
</ul>

</div>
            </div>
        </div>                    

      <div class="clearer"></div>
    </div><div class="pagenation">
     <a id="button-prev" href="custom_layer_beginners.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="P">
         <i class="pagenation-arrow-L fas fa-arrow-left fa-lg"></i>
         <div class="pagenation-text">
            <span class="pagenation-direction">Previous</span>
            <div>How to write a custom layer in Apache MxNet Gluon API</div>
         </div>
     </a>
     <a id="button-next" href="image-augmentation.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="N">
         <i class="pagenation-arrow-R fas fa-arrow-right fa-lg"></i>
        <div class="pagenation-text">
            <span class="pagenation-direction">Next</span>
            <div>Image Augmentation</div>
        </div>
     </a>
  </div>
            <footer class="site-footer h-card">
    <div class="wrapper">
        <div class="row">
            <div class="col-4">
                <h4 class="footer-category-title">Resources</h4>
                <ul class="contact-list">
                    <li><a class="u-email" href="mailto:dev@mxnet.apache.org">Dev list</a></li>
                    <li><a class="u-email" href="mailto:user@mxnet.apache.org">User mailing list</a></li>
                    <li><a href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home">Developer Wiki</a></li>
                    <li><a href="https://issues.apache.org/jira/projects/MXNET/issues">Jira Tracker</a></li>
                    <li><a href="https://github.com/apache/incubator-mxnet/labels/Roadmap">Github Roadmap</a></li>
                    <li><a href="https://discuss.mxnet.io">MXNet Discuss forum</a></li>
                    <li><a href="/mxnet.io-v2/community/contribute">Contribute To MXNet</a></li>

                </ul>
            </div>

            <div class="col-4"><ul class="social-media-list"><li><a href="https://github.com/apache/incubator-mxnet"><svg class="svg-icon"><use xlink:href="../../../_static/minima-social-icons.svg#github"></use></svg> <span class="username">apache/incubator-mxnet</span></a></li><li><a href="https://www.twitter.com/apachemxnet"><svg class="svg-icon"><use xlink:href="../../../_static/minima-social-icons.svg#twitter"></use></svg> <span class="username">apachemxnet</span></a></li><li><a href="https://youtube.com/apachemxnet"><svg class="svg-icon"><use xlink:href="../../../_static/minima-social-icons.svg#youtube"></use></svg> <span class="username">apachemxnet</span></a></li></ul>
</div>

            <div class="col-4 footer-text">
                <p>A flexible and efficient library for deep learning.</p>
            </div>
        </div>
    </div>
</footer>

<footer class="site-footer2">
    <div class="wrapper">
        <div class="row">
            <div class="col-3">
                <img src="../../../_static/apache_incubator_logo.png" class="footer-logo col-2">
            </div>
            <div class="footer-bottom-warning col-9">
                <p>Apache MXNet is an effort undergoing incubation at The Apache Software Foundation (ASF), <span style="font-weight:bold">sponsored by the <i>Apache Incubator</i></span>. Incubation is required
                    of all newly accepted projects until a further review indicates that the infrastructure,
                    communications, and decision making process have stabilized in a manner consistent with other
                    successful ASF projects. While incubation status is not necessarily a reflection of the completeness
                    or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
                </p><p>"Copyright © 2017-2018, The Apache Software Foundation Apache MXNet, MXNet, Apache, the Apache
                    feather, and the Apache MXNet project logo are either registered trademarks or trademarks of the
                    Apache Software Foundation."</p>
            </div>
        </div>
    </div>
</footer>
        
  </body>
</html>